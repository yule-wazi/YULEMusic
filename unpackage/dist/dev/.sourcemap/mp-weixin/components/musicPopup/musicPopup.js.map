{"version":3,"file":"musicPopup.js","sources":["components/musicPopup/musicPopup.vue","../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovdW5pQXBw5a2m5LmgL1lVTEVNdXNpYy9jb21wb25lbnRzL211c2ljUG9wdXAvbXVzaWNQb3B1cC52dWU"],"sourcesContent":["<template>\n\t<uni-popup ref=\"popup\" type=\"bottom\" background-color=\"#fff\" border-radius=\"10px 10px 0 0\">\r\n\t\t<view class=\"order\">\r\n\t\t\t<button class=\"orderButton\" @click=\"orderChange\">\r\n\t\t\t\t<image :src=\"`/static/list_${playerStore.currentOrderName}.png`\" />\r\n\t\t\t\t<text class=\"text\">{{orderName}}</text>\r\n\t\t\t</button>\r\n\t\t\t<button class=\"timer\" @click='timerPopup.open()'>\r\n\t\t\t\t定时器\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t\t<view class=\"songList\">\r\n\t\t\t<template v-for=\"(item, index) in playerStore.songList\">\r\n\t\t\t\t<view class=\"item\" \r\n\t\t\t\t\t:class=\"{active: index === playerStore.songIndex}\" \r\n\t\t\t\t>\r\n\t\t\t\t\t<view class=\"content\" @click=\"changeSong(index)\">\r\n\t\t\t\t\t\t<text class=\"songName\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"singer\" \r\n\t\t\t\t\t\t\t:class=\"{active: index === playerStore.songIndex}\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t· {{item.ar[0].name}}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"destroy\" @click=\"popItem(index)\">\r\n\t\t\t\t\t\t<uni-icons type=\"closeempty\" size=\"35rpx\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</view>\r\n\t\t<uni-popup ref=\"timerPopup\" type=\"top\" background-color=\"#fff\" border-radius=\"0 0 10px 10px\">\r\n\t\t\t<view class=\"timerSelector\">\r\n\t\t\t\t<template v-for=\"(item, index) in timerList\">\r\n\t\t\t\t\t<view class=\"timerItem\" @click=\"timerClick(index)\">\r\n\t\t\t\t\t\t<view class=\"timerContent\">\r\n\t\t\t\t\t\t\t<text class=\"text\">{{item.label}}</text>\r\n\t\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\t\tv-if=\"playerStore.timerActive === index && index\" \r\n\t\t\t\t\t\t\t\tclass=\"countdown\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{{formatPlayTime(timerDuration)}}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<image v-if=\"index === playerStore.timerActive\" class=\"timerActive\" src=\"/static/check_item.png\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</template>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</uni-popup>\r\n</template>\n\n<script setup>\nimport { computed, ref } from 'vue';\nimport usePlayer from '../../store/module/player';\r\nimport { formatPlayTime } from '../../utils/formatView';\r\nimport { audioInstance } from '../../utils/audioInstance';\n\r\nconst audioContext = audioInstance()\nconst playerStore = usePlayer()\r\nconst popup = ref()\r\nconst timerPopup = ref()\r\nconst openList = () => {\r\n\tpopup.value.open()\r\n}\r\nconst orderName = computed(() => {\r\n\tswitch(playerStore.currentOrderName) {\r\n\t\tcase 'order': \r\n\t\t\treturn '列表循环'\r\n\t\tcase 'repeat':\r\n\t\t\treturn '单曲循环'\r\n\t\tcase 'random':\r\n\t\t\treturn '随机播放'\r\n\t\tdefault: \r\n\t\t\treturn '其他'\r\n\t}\r\n})\r\n// 切换模式\nconst orderChange = () => {\r\n\tconst orderName = [\"order\", \"repeat\", \"random\"]\n\tlet currentOrder = playerStore.currentOrder\n\tcurrentOrder = (currentOrder + 1) % 3\r\n\tplayerStore.currentOrder = currentOrder\r\n\tplayerStore.currentOrderName = orderName[currentOrder]\n}\r\n// 切歌\r\nconst changeSong = (index, isForce = false) => {\r\n\tif(playerStore.songIndex === index && !isForce) return\r\n\tplayerStore.songIndex = index\r\n\tconst currentId = playerStore.songList[index].id\r\n\tplayerStore.playSong(currentId)\r\n}\r\n// 删除该项\r\nconst popItem = (index) => {\r\n\tconst newList = [...playerStore.songList.slice(0, index), ...playerStore.songList.slice(index+1)] \r\n\tplayerStore.songList = newList\r\n\tif(index < playerStore.songIndex) {\r\n\t\tplayerStore.songIndex--\r\n\t} else if (index === playerStore.songIndex) {\r\n\t\tchangeSong(index, true)\r\n\t}\r\n}\r\n// 定时选项\r\nconst timerList = [\r\n\t{label: '不开启', value: 0},\r\n\t{label: '10秒钟', value: 10000},\r\n\t{label: '15分钟', value: 900000},\r\n\t{label: '30分钟', value: 1800000},\r\n\t{label: '60分钟', value: 3600000},\r\n\t{label: '90分钟', value: 5400000},\r\n]\r\nconst timerDuration = ref(0)\r\ndefineExpose({\r\n\topenList\r\n})\r\n// 选择定时时间\r\nlet timer = null\r\nconst timerClick = (index) => {\r\n\tplayerStore.timerActive = index\r\n\ttimerPopup.value.close()\r\n\ttimerDuration.value = timerList[index].value\r\n\t// 开启定时关闭\r\n\tif(timer) {\r\n\t\tclearInterval(timer)\r\n\t}\r\n\tif(index) {\r\n\t\ttimer = setInterval(setTimer, 1000)\r\n\t}\r\n}\r\n// 设置定时器\r\nconst setTimer = () => {\r\n\ttimerDuration.value -= 1000\r\n\tif(!timerDuration.value) {\r\n\t\tconsole.log('时间到了');\r\n\t\taudioContext.pause()\r\n\t\tplayerStore.isPlaying = false\r\n\t\tclearInterval(timer)\r\n\t\tplayerStore.timerActive = 0\r\n\t\tuni.setKeepScreenOn({\r\n\t\t\tkeepScreenOn: false,\r\n\t\t\tsuccess: () => {\r\n\t\t\t\tconsole.log('关闭常亮');\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.log('失败',err);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tconsole.log('timerDuration.value=', timerDuration.value);\r\n}\r\n</script>\n\n<style lang=\"scss\">\n.order {\r\n\theight: 100rpx;\r\n\tdisplay: flex;\r\n\t.orderButton {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 260rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 40rpx;\r\n\t\t&::after {\r\n\t\t\tborder: none;\r\n\t\t}\r\n\t\tbackground-color: #F6F6F6;\r\n\t\tmargin: 20rpx 0 0 20rpx;\r\n\t\timage {\r\n\t\t\twidth: 40rpx;\r\n\t\t\theight:40rpx;\r\n\t\t}\r\n\t\t.text {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\t}\r\n}\r\n.songList {\r\n\theight: 900rpx;\r\n\toverflow: scroll;\r\n\t&::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t}\r\n\tdisplay: flex;\t\r\n\tflex-direction: column;\r\n\t.item {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 30rpx 30rpx;\r\n\t\tjustify-content: space-between;\r\n\t\t.content {\r\n\t\t\twidth: 90%;\r\n\t\t\tdisplay: -webkit-box;\r\n\t\t\t-webkit-line-clamp: 1;\r\n\t\t\t-webkit-box-orient: vertical;\r\n\t\t\toverflow: hidden;\r\n\t\t\t.songName {\r\n\t\t\t\tfont-size: 35rpx;\r\n\t\t\t}\r\n\t\t\t.singer {\r\n\t\t\t\tfont-size: 25rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.destroy {\r\n\t\t\twidth: 10%;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\t}\r\n\t.active {\r\n\t\tbackground-color: #F6F6F6;\r\n\t\tcolor: #26CE8A !important;\r\n\t}\r\n}\r\n.timerSelector {\r\n\t.timerItem {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 30rpx;\r\n\t\tborder-top: 1rpx solid rgba(155,155,155,0.5);\r\n\t\t.timerContent {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\t.text {\r\n\t\t\t\tfont-size: 35rpx;\r\n\t\t\t}\r\n\t\t\t.countdown {\r\n\t\t\t\tmargin-left: 40rpx;\r\n\t\t\t\tfont-size: 25rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.timerActive {\r\n\t\t\theight: 40rpx;\r\n\t\t\twidth: 40rpx;\r\n\t\t}\r\n\t}\r\n}\n</style>","import Component from 'D:/uniApp学习/YULEMusic/components/musicPopup/musicPopup.vue'\nwx.createComponent(Component)"],"names":["audioInstance","usePlayer","ref","computed","orderName","uni","Component"],"mappings":";;;;;;;;;;;;;;;;;;;AAyDA,UAAM,eAAeA,oBAAAA,cAAe;AACpC,UAAM,cAAcC,oBAAAA,UAAW;AAC/B,UAAM,QAAQC,cAAAA,IAAK;AACnB,UAAM,aAAaA,cAAAA,IAAK;AACxB,UAAM,WAAW,MAAM;AACtB,YAAM,MAAM,KAAM;AAAA,IACnB;AACA,UAAM,YAAYC,cAAQ,SAAC,MAAM;AAChC,cAAO,YAAY,kBAAgB;AAAA,QAClC,KAAK;AACJ,iBAAO;AAAA,QACR,KAAK;AACJ,iBAAO;AAAA,QACR,KAAK;AACJ,iBAAO;AAAA,QACR;AACC,iBAAO;AAAA,MACR;AAAA,IACF,CAAC;AAED,UAAM,cAAc,MAAM;AACzB,YAAMC,aAAY,CAAC,SAAS,UAAU,QAAQ;AAC9C,UAAI,eAAe,YAAY;AAC/B,sBAAgB,eAAe,KAAK;AACpC,kBAAY,eAAe;AAC3B,kBAAY,mBAAmBA,WAAU,YAAY;AAAA,IACtD;AAEA,UAAM,aAAa,CAAC,OAAO,UAAU,UAAU;AAC9C,UAAG,YAAY,cAAc,SAAS,CAAC;AAAS;AAChD,kBAAY,YAAY;AACxB,YAAM,YAAY,YAAY,SAAS,KAAK,EAAE;AAC9C,kBAAY,SAAS,SAAS;AAAA,IAC/B;AAEA,UAAM,UAAU,CAAC,UAAU;AAC1B,YAAM,UAAU,CAAC,GAAG,YAAY,SAAS,MAAM,GAAG,KAAK,GAAG,GAAG,YAAY,SAAS,MAAM,QAAM,CAAC,CAAC;AAChG,kBAAY,WAAW;AACvB,UAAG,QAAQ,YAAY,WAAW;AACjC,oBAAY;AAAA,MACd,WAAY,UAAU,YAAY,WAAW;AAC3C,mBAAW,OAAO,IAAI;AAAA,MACtB;AAAA,IACF;AAEA,UAAM,YAAY;AAAA,MACjB,EAAC,OAAO,OAAO,OAAO,EAAC;AAAA,MACvB,EAAC,OAAO,QAAQ,OAAO,IAAK;AAAA,MAC5B,EAAC,OAAO,QAAQ,OAAO,IAAM;AAAA,MAC7B,EAAC,OAAO,QAAQ,OAAO,KAAO;AAAA,MAC9B,EAAC,OAAO,QAAQ,OAAO,KAAO;AAAA,MAC9B,EAAC,OAAO,QAAQ,OAAO,KAAO;AAAA,IAC/B;AACA,UAAM,gBAAgBF,cAAG,IAAC,CAAC;AAC3B,aAAa;AAAA,MACZ;AAAA,IACD,CAAC;AAED,QAAI,QAAQ;AACZ,UAAM,aAAa,CAAC,UAAU;AAC7B,kBAAY,cAAc;AAC1B,iBAAW,MAAM,MAAO;AACxB,oBAAc,QAAQ,UAAU,KAAK,EAAE;AAEvC,UAAG,OAAO;AACT,sBAAc,KAAK;AAAA,MACnB;AACD,UAAG,OAAO;AACT,gBAAQ,YAAY,UAAU,GAAI;AAAA,MAClC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM;AACtB,oBAAc,SAAS;AACvB,UAAG,CAAC,cAAc,OAAO;AACxBG,sBAAAA,MAAY,MAAA,OAAA,+CAAA,MAAM;AAClB,qBAAa,MAAO;AACpB,oBAAY,YAAY;AACxB,sBAAc,KAAK;AACnB,oBAAY,cAAc;AAC1BA,sBAAAA,MAAI,gBAAgB;AAAA,UACnB,cAAc;AAAA,UACd,SAAS,MAAM;AACdA,0BAAAA,MAAA,MAAA,OAAA,+CAAY,MAAM;AAAA,UAClB;AAAA,UACD,MAAM,CAAC,QAAQ;AACdA,0BAAA,MAAA,MAAA,OAAA,+CAAY,MAAK,GAAG;AAAA,UACpB;AAAA,QACJ,CAAG;AAAA,MACD;AACDA,oBAAA,MAAA,MAAA,OAAA,+CAAY,wBAAwB,cAAc,KAAK;AAAA,IACxD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnJA,GAAG,gBAAgBC,SAAS;"}