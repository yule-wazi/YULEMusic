{"version":3,"file":"mainSearch.js","sources":["pages/mainSearch/mainSearch.vue","../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWFpblNlYXJjaC9tYWluU2VhcmNoLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"mainSearch\">\r\n\t\t<uni-search-bar \r\n\t\t\tplaceholder=\"请输入搜索关键词\"\r\n\t\t\t@input=\"searchChange\"\r\n\t\t\t@focus=\"searchFocus\"\r\n\t\t\t@blur=\"searchBlur\"\r\n\t\t\t@confirm=\"searchClick\"\r\n\t\t/>\r\n\t\t<!-- 热门搜索 -->\r\n\t\t<searchHot \r\n\t\t\tv-if=\"data.searchSuggest.length === 0 && data.searchSongs.length === 0\"\r\n\t\t\t:searchHotList=\"data.searchHotList\" \r\n\t\t\t@searchHotItemEmit=\"searchHotClick\"\r\n\t\t/>\r\n\t\t<!-- 搜索结果 -->\r\n\t\t<searchResult \r\n\t\t\tv-if=\"!data.isFocus && data.searchSongs.length > 0\"\r\n\t\t\t:songs=\"data.searchSongs\"\r\n\t\t/>\r\n\t\t<!-- 搜索建议 -->\r\n\t\t<searchSuggest \r\n\t\t\tv-else\r\n\t\t\t:searchSuggest=\"data.searchSuggest\"\r\n\t\t\t@searchSuggestItemEmit=\"searchSuggestClick\"\r\n\t\t/>\r\n\t\t<playerBar />\r\n\t</view>\n</template>\n\n<script setup>\nimport { reactive } from 'vue'\nimport { fetchSearchHotList, fetchSearchKeyword, fetchSearchSuggest } from '@/service/module/search'\r\nimport { onLoad, onReachBottom } from '@dcloudio/uni-app'\nonLoad(() => {\r\n\tgetSearchHotList()\r\n})\r\nconst data = reactive({\n\tsearchHotList: [],\r\n\tsearchSuggest: [],\r\n\tsearchSongs: [],\r\n\tkeyword: \"\",\r\n\tisFocus: false\n})\r\n// 获取热门搜索\nconst getSearchHotList = async() => {\n\tconst res = await fetchSearchHotList()\n\tconst searchHotList = res.data.result.hots\n\tdata.searchHotList = searchHotList\r\n}\r\n// 热门搜索点击\nconst searchHotClick = (value) => {\r\n\tdata.keyword = value\n\tsearchClick()\n}\r\n// 搜索聚焦\r\nconst searchFocus = () => {\r\n\tdata.isFocus = true\r\n\tdata.searchSongs = []\r\n\tdata.keyword = ''\r\n}\r\n// 搜索失焦\r\nconst searchBlur = () => {\r\n\tdata.isFocus = false\r\n}\r\n// 搜索建议\r\nconst searchChange = async(value) => {\r\n\tdata.keyword = value\r\n\tif(!value) {\r\n\t  data.searchSuggest = []\r\n\t  return\r\n\t}\r\n\tconst res = await fetchSearchSuggest(value)\r\n\tconst searchSuggest = res.data.result.songs\r\n\tdata.searchSuggest = searchSuggest\r\n}\r\n// 推荐搜索点击\nconst searchSuggestClick = (value) => {\r\n\tdata.keyword = value\n\tsearchClick()\n}\r\n// 点击搜索按钮\nconst searchClick = async(isLoadMore = false, offset = 0) => {\n\tconst value = data.keyword\n\tif(!value)return\n\tconst res = await fetchSearchKeyword(value, offset)\n\tconst searchSongs = res.data.result.songs\r\n\tif(!isLoadMore) {\r\n\t\tdata.searchSongs = searchSongs\r\n\t} else {\r\n\t\tdata.searchSongs.push(...searchSongs)\r\n\t}\r\n}\r\n// // 触底刷新\r\nonReachBottom(() => {\r\n\tsearchClick(true, data.searchSongs.length)\r\n})\n</script>\n\n<style lang=\"scss\">\n.mainSearch {\n  padding: 20rpx;\r\n  padding-bottom: 120rpx;\r\n}\n</style>\n","import MiniProgramPage from 'D:/uniApp学习/YULEMusic/pages/mainSearch/mainSearch.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","reactive","fetchSearchHotList","fetchSearchSuggest","fetchSearchKeyword","onReachBottom","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAkCAA,kBAAAA,OAAO,MAAM;AACZ,uBAAkB;AAAA,IACnB,CAAC;AACD,UAAM,OAAOC,cAAAA,SAAS;AAAA,MACrB,eAAe,CAAE;AAAA,MACjB,eAAe,CAAE;AAAA,MACjB,aAAa,CAAE;AAAA,MACf,SAAS;AAAA,MACT,SAAS;AAAA,IACV,CAAC;AAED,UAAM,mBAAmB,YAAW;AACnC,YAAM,MAAM,MAAMC,yCAAoB;AACtC,YAAM,gBAAgB,IAAI,KAAK,OAAO;AACtC,WAAK,gBAAgB;AAAA,IACtB;AAEA,UAAM,iBAAiB,CAAC,UAAU;AACjC,WAAK,UAAU;AACf,kBAAa;AAAA,IACd;AAEA,UAAM,cAAc,MAAM;AACzB,WAAK,UAAU;AACf,WAAK,cAAc,CAAE;AACrB,WAAK,UAAU;AAAA,IAChB;AAEA,UAAM,aAAa,MAAM;AACxB,WAAK,UAAU;AAAA,IAChB;AAEA,UAAM,eAAe,OAAM,UAAU;AACpC,WAAK,UAAU;AACf,UAAG,CAAC,OAAO;AACT,aAAK,gBAAgB,CAAE;AACvB;AAAA,MACD;AACD,YAAM,MAAM,MAAMC,sBAAkB,mBAAC,KAAK;AAC1C,YAAM,gBAAgB,IAAI,KAAK,OAAO;AACtC,WAAK,gBAAgB;AAAA,IACtB;AAEA,UAAM,qBAAqB,CAAC,UAAU;AACrC,WAAK,UAAU;AACf,kBAAa;AAAA,IACd;AAEA,UAAM,cAAc,OAAM,aAAa,OAAO,SAAS,MAAM;AAC5D,YAAM,QAAQ,KAAK;AACnB,UAAG,CAAC;AAAM;AACV,YAAM,MAAM,MAAMC,yCAAmB,OAAO,MAAM;AAClD,YAAM,cAAc,IAAI,KAAK,OAAO;AACpC,UAAG,CAAC,YAAY;AACf,aAAK,cAAc;AAAA,MACrB,OAAQ;AACN,aAAK,YAAY,KAAK,GAAG,WAAW;AAAA,MACpC;AAAA,IACF;AAEAC,kBAAAA,cAAc,MAAM;AACnB,kBAAY,MAAM,KAAK,YAAY,MAAM;AAAA,IAC1C,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/FD,GAAG,WAAWC,SAAe;"}